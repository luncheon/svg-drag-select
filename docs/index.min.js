var svgDragSelect=function(){"use strict"
function l(e,t,n){return t<=e&&e<=n}function f(e,t,n,r){return e.getEnclosureList?Array.prototype.slice.call(e.getEnclosureList(r,t)):a([],e,t||e,function(e){return function(e,t){var n=e.x,r=n+e.width,i=e.y,o=i+e.height
return l(t.x,n,r)&&l(t.x+t.width,n,r)&&l(t.y,i,o)&&l(t.y+t.height,i,o)}(n,e.getBBox())})}function p(e,t,n,r){return e.getIntersectionList?Array.prototype.slice.call(e.getIntersectionList(r,t)):a([],e,t||e,function(e){return function(e,t){var n=e.x,r=n+e.width,i=e.y,o=i+e.height
return(l(t.x,n,r)||l(t.x+t.width,n,r)||l(n,t.x,t.x+t.width))&&(l(t.y,i,o)||l(t.y+t.height,i,o)||l(i,t.y,t.y+t.height))}(n,e.getBBox())})}function y(e,t){return e.filter(function(e){return-1===t.indexOf(e)})}function S(e,t,n,r,i){var o=e.createSVGRect()
return o.x=Math.min(t,r),o.y=Math.min(n,i),o.width=Math.abs(t-r),o.height=Math.abs(n-i),o}function x(e,t,n){if(!t)return n
var r=e.createSVGPoint()
r.x=n.x,r.y=n.y
var i=r.matrixTransform(t)
r.x+=n.width,r.y+=n.height
var o=r.matrixTransform(t)
return S(e,i.x,i.y,o.x,o.y)}var c=[SVGCircleElement,SVGEllipseElement,SVGImageElement,SVGLineElement,SVGPathElement,SVGPolygonElement,SVGPolylineElement,SVGRectElement,SVGTextElement,SVGUseElement],a=function(e,t,n,r){for(var i=n.firstElementChild;i;i=i.nextElementSibling)if(i instanceof SVGGElement)a(e,t,i,r)
else for(var o=0,l=c;o<l.length;o++){i instanceof l[o]&&r(i)&&e.push(i)}return e}
return function(m){function g(e){return S(t,n-document.documentElement.scrollLeft-document.body.scrollLeft,r-document.documentElement.scrollTop-document.body.scrollTop,e.clientX,e.clientY)}var h,n,r,v=[],t=m.svg,e=document.body.appendChild(document.createElement("div")),E=e.style
e.className="svg-drag-select-area-overlay",E.position="fixed",E.pointerEvents="none"
function i(e){var t=this
if(e.pointerId===h){var n=g(e),r=x(this,this.getScreenCTM().inverse(),n),i=x(this,this.getCTM(),r),o=m.referenceElement||null,l=function(){return f(t,o,r,i)},c=function(){return p(t,o,r,i)},a="function"==typeof m.selector?m.selector({svg:this,referenceElement:o,pointerEvent:e,dragAreaInClientCoordinate:n,dragAreaInSvgCoordinate:r,dragAreaInInitialSvgCoordinate:i,getEnclosures:l,getIntersections:c}):"intersection"===m.selector?c():l(),s=y(a,v),d=y(v,a)
if(E.left=n.x+"px",E.top=n.y+"px",E.width=n.width+"px",E.height=n.height+"px",s.length||d.length){var u=v
v=a,m.onSelectionChange&&m.onSelectionChange({svg:this,referenceElement:o,pointerEvent:e,dragAreaInClientCoordinate:n,dragAreaInSvgCoordinate:r,dragAreaInInitialSvgCoordinate:i,selectedElements:v,previousSelectedElements:u,newlySelectedElements:s,newlyDeselectedElements:d})}}}function o(e){var t
e.isPrimary&&void 0===h&&(m.onSelectionStart&&m.onSelectionStart({svg:this,referenceElement:m.referenceElement||null,pointerEvent:e,cancel:function(){return t=1}}),t||(h=e.pointerId,n=e.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,r=e.clientY+document.documentElement.scrollTop+document.body.scrollTop,v=[],i.call(this,e),E.display="",this.setPointerCapture(h)))}function l(e){if(e.pointerId===h){this.releasePointerCapture(h),h=void 0,E.display="none"
var t=g(e),n=x(this,this.getScreenCTM().inverse(),t),r=x(this,this.getCTM(),n)
m.onSelectionEnd&&m.onSelectionEnd({svg:this,referenceElement:m.referenceElement||null,pointerEvent:e,dragAreaInClientCoordinate:t,dragAreaInSvgCoordinate:n,dragAreaInInitialSvgCoordinate:r,selectedElements:v})}}var c=t.getAttribute("draggable"),a=t.style.pointerEvents,s=t.style.touchAction,d=getComputedStyle(t).touchAction,u="none"!==getComputedStyle(t).touchAction&&"pinch-zoom"!==d
return u&&(t.style.touchAction="manipulation",t.style.touchAction="pinch-zoom"),t.style.pointerEvents="all",t.setAttribute("draggable","false"),t.addEventListener("pointerdown",o),t.addEventListener("pointermove",i),t.addEventListener("pointerup",l),t.addEventListener("pointercancel",l),{dragAreaOverlay:e,cancel:function(){null===c?t.removeAttribute("draggable"):t.setAttribute("draggable",c),t.style.pointerEvents=a,u&&(t.style.touchAction=s),t.removeEventListener("pointerdown",o),t.removeEventListener("pointermove",i),t.removeEventListener("pointerup",l),t.removeEventListener("pointercancel",l),e.parentElement&&e.parentElement.removeChild(e)}}}}()
